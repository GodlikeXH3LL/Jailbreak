
local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/memejames/elerium-v2-ui-library/main/Library", true))()

local window = library:AddWindow("JailBreak | MODDED", {
    main_color = Color3.fromRGB(0, 0, 0),
    min_size = Vector2.new(470, 470),
    can_resize = true,
})

local Main = window:AddTab("Player")
local folder1 = Main:AddFolder("Other Players")

folder1:AddSwitch("ESP", function(state)
    esp = state
    if state then
        local Players = game:GetService("Players")
        local RunService = game:GetService("RunService")
        local Camera = workspace.CurrentCamera

        local LocalPlayer = Players.LocalPlayer
        local ESPObjects = {}

        local function CreateESP(player)
            if player == LocalPlayer then return end
            
            local Box = Drawing.new("Square")
            Box.Thickness = 2
            Box.Color = Color3.new(1, 0, 0)
            Box.Filled = false
            Box.Transparency = 1
            Box.Visible = false
            
            local NameTag = Drawing.new("Text")
            NameTag.Size = 16
            NameTag.Color = Color3.new(1, 1, 1)
            NameTag.Outline = true
            NameTag.Center = true
            NameTag.Visible = false
            
            local DistanceTag = Drawing.new("Text")
            DistanceTag.Size = 14
            DistanceTag.Color = Color3.new(1, 1, 1)
            DistanceTag.Outline = true
            DistanceTag.Center = true
            DistanceTag.Visible = false
            
            ESPObjects[player] = {
                Box = Box,
                NameTag = NameTag,
                DistanceTag = DistanceTag
            }
        end

        local function RemoveESP(player)
            if ESPObjects[player] then
                ESPObjects[player].Box:Remove()
                ESPObjects[player].NameTag:Remove()
                ESPObjects[player].DistanceTag:Remove()
                ESPObjects[player] = nil
            end
        end

        local function UpdateESP()
            for player, objects in pairs(ESPObjects) do
                local character = player.Character
                if character and character:FindFirstChild("HumanoidRootPart") then
                    local rootPart = character.HumanoidRootPart
                    local position, onScreen = Camera:WorldToViewportPoint(rootPart.Position)
                    
                    if onScreen then
                        objects.Box.Visible = true
                        objects.NameTag.Visible = true
                        objects.DistanceTag.Visible = true
                        
                        objects.Box.Size = Vector2.new(2000 / position.Z, 2000 / position.Z)
                        objects.Box.Position = Vector2.new(position.X - objects.Box.Size.X / 2, position.Y - objects.Box.Size.Y / 2)
                        
                        objects.NameTag.Text = player.Name
                        objects.NameTag.Position = Vector2.new(position.X, position.Y - objects.Box.Size.Y / 2 - 20)
                        
                        local distance = (LocalPlayer.Character and LocalPlayer.Character.HumanoidRootPart and (rootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude) or 0
                        objects.DistanceTag.Text = string.format("%.1f studs", distance)
                        objects.DistanceTag.Position = Vector2.new(position.X, position.Y + objects.Box.Size.Y / 2 + 10)
                    else
                        objects.Box.Visible = false
                        objects.NameTag.Visible = false
                        objects.DistanceTag.Visible = false
                    end
                else
                    objects.Box.Visible = false
                    objects.NameTag.Visible = false
                    objects.DistanceTag.Visible = false
                end
            end
        end

        for _, player in pairs(Players:GetPlayers()) do
            CreateESP(player)
        end

        Players.PlayerAdded:Connect(CreateESP)
        Players.PlayerRemoving:Connect(RemoveESP)
        RunService.RenderStepped:Connect(UpdateESP)
    else
        for player, objects in pairs(ESPObjects or {}) do
            RemoveESP(player)
        end
        ESPObjects = {}
    end
end)
